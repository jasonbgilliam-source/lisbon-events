import { NextResponse } from 'next/server'; import { supabaseServer } from '@/lib/supabaseServer'; export async function POST(req:Request){try{const b=await req.json(); for(const k of ['title','description','starts_at','location_name','organizer_email']) if(!b[k]) return NextResponse.json({error:`Missing ${k}`},{status:400}); const sb=supabaseServer(); const {error}=await sb.from('event_submissions').insert({title:b.title,description:b.description,starts_at:new Date(b.starts_at).toISOString(),ends_at:b.ends_at?new Date(b.ends_at).toISOString():null,location_name:b.location_name,address:b.address||null,ticket_url:b.ticket_url||null,image_url:b.image_url||null,organizer_email:b.organizer_email,status:'pending'}); if(error) return NextResponse.json({error:error.message},{status:500}); return NextResponse.json({ok:true}); }catch(e:any){ return NextResponse.json({error:e.message},{status:500}); }}