(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{953:function(e,t,s){Promise.resolve().then(s.bind(s,1641))},1641:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return a}});var n=s(7437),i=s(2265);function a(){let[e,t]=i.useState([]),[s,a]=i.useState(!0),[r,l]=i.useState(null);async function c(){a(!0),l(null);try{let e=await fetch("/api/submissions/list",{cache:"no-store"});if(!(e.headers.get("content-type")||"").includes("application/json")){let t=await e.text();throw Error("Expected JSON from /api/submissions/list, got ".concat(e.status,". First bytes: ").concat(t.slice(0,120)))}let s=await e.json();if(!e.ok)throw Error(s.error||e.statusText);t(s.items||[])}catch(e){l(e.message||"Failed to load")}finally{a(!1)}}async function o(e,t){let s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),cache:"no-store"}),n=(s.headers.get("content-type")||"").includes("application/json")?await s.json():{};if(!s.ok)throw Error(n.error||s.statusText);return n}async function d(e){t(t=>t.filter(t=>t.id!==e));try{await o("/api/submissions/approve",{id:e,reviewer:"admin",notes:""}),alert("Approved + published")}catch(e){alert("Approve failed: ".concat(e.message||e)),c()}}async function u(e){let s=prompt("Optional note for rejection")||"";t(t=>t.filter(t=>t.id!==e));try{await o("/api/submissions/reject",{id:e,reviewer:"admin",notes:s}),alert("Rejected")}catch(e){alert("Reject failed: ".concat(e.message||e)),c()}}return i.useEffect(()=>{c()},[]),(0,n.jsxs)("main",{className:"p-6 max-w-5xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Pending Event Submissions"}),(0,n.jsx)("button",{className:"border px-3 py-1 rounded",onClick:c,disabled:s,children:s?"Loading…":"Refresh"})]}),r&&(0,n.jsxs)("p",{className:"text-red-700 mb-3",children:["Error: ",r]}),!r&&s&&(0,n.jsx)("p",{children:"Loading…"}),!s&&0===e.length&&(0,n.jsx)("p",{children:"No pending submissions \uD83C\uDF89"}),(0,n.jsx)("ul",{className:"space-y-4",children:e.map(e=>(0,n.jsx)("li",{className:"border rounded p-4",children:(0,n.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"font-medium",children:[e.title||"(no title)"," ",(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:["#",e.id.slice(0,8)]})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[e.starts_at||""," ",e.location_name?"@ ".concat(e.location_name):""]}),e.description?(0,n.jsx)("p",{className:"mt-2 text-sm",children:e.description}):null,e.ticket_url?(0,n.jsx)("a",{className:"text-sm underline mr-3",href:e.ticket_url,target:"_blank",rel:"noreferrer",children:"Tickets"}):null,e.image_url?(0,n.jsx)("a",{className:"text-sm underline",href:e.image_url,target:"_blank",rel:"noreferrer",children:"Image"}):null]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"border px-3 py-1 rounded",onClick:()=>d(e.id),children:"Approve"}),(0,n.jsx)("button",{className:"border px-3 py-1 rounded",onClick:()=>u(e.id),children:"Reject"})]})]})},e.id))})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=953)}),_N_E=e.O()}]);