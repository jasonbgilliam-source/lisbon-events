(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[313],{2616:function(e,a,t){Promise.resolve().then(t.bind(t,1609))},1609:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l}});var s=t(7437),n=t(2265);function l(){let[e,a]=n.useState([]),[t,l]=n.useState(!0),[r,i]=n.useState(null),[c,o]=n.useState(""),[d,m]=n.useState(""),[u,x]=n.useState("");async function h(){l(!0),i(null);try{let e=await fetch("/api/categories/list",{cache:"no-store"}),t=await e.json();if(!e.ok)throw Error(t.error||e.statusText);a((t.categories||[]).map(e=>({name:e})))}catch(e){i(e.message||"Failed to load categories")}finally{l(!1)}}async function p(e,a){let t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","x-admin-key":c||""},body:JSON.stringify(a)}),s=await t.json().catch(()=>({}));if(!t.ok)throw Error(s.error||t.statusText);return s}async function f(){if(!d.trim()){alert("Enter a category name");return}try{await p("/api/categories/upsert",{name:d.trim(),renameFrom:u.trim()||void 0}),m(""),x(""),await h(),alert("Saved")}catch(e){alert(e.message||"Failed to save")}}async function b(e){if(confirm('Delete category "'.concat(e,'"?')))try{await p("/api/categories/delete",{name:e}),await h()}catch(e){alert(e.message||"Failed to delete")}}return n.useEffect(()=>{h()},[]),(0,s.jsxs)("main",{className:"p-6 max-w-3xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Category Catalog (Admin)"}),(0,s.jsxs)("div",{className:"border rounded p-3 mb-4",children:[(0,s.jsx)("label",{className:"block text-xs font-medium",children:"Admin Key"}),(0,s.jsx)("input",{type:"password",className:"border p-2 w-full",placeholder:"Enter ADMIN_KEY",value:c,onChange:e=>o(e.target.value)}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["This is sent only as a header to protected endpoints. Set ",(0,s.jsx)("code",{children:"ADMIN_KEY"})," in your Vercel env."]})]}),(0,s.jsxs)("div",{className:"border rounded p-3 mb-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{className:"md:col-span-1",children:[(0,s.jsx)("label",{className:"block text-xs font-medium",children:"Rename From (optional)"}),(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Existing name",value:u,onChange:e=>x(e.target.value),list:"catlist"})]}),(0,s.jsxs)("div",{className:"md:col-span-1",children:[(0,s.jsx)("label",{className:"block text-xs font-medium",children:"New Name"}),(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"New or existing name",value:d,onChange:e=>m(e.target.value)})]}),(0,s.jsx)("div",{className:"md:col-span-1 flex items-end",children:(0,s.jsx)("button",{className:"border px-3 py-2 rounded w-full",onClick:f,children:"Save"})}),(0,s.jsx)("datalist",{id:"catlist",children:e.map(e=>(0,s.jsx)("option",{value:e.name},e.name))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Existing Categories"}),(0,s.jsx)("button",{className:"border px-3 py-1 rounded",onClick:h,disabled:t,children:t?"Loading…":"Refresh"})]}),r&&(0,s.jsxs)("p",{className:"text-red-700 mb-3",children:["Error: ",r]}),!r&&t&&(0,s.jsx)("p",{children:"Loading…"}),(0,s.jsx)("ul",{className:"space-y-2",children:e.map(e=>(0,s.jsxs)("li",{className:"border rounded p-3 flex items-center justify-between",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)("button",{className:"border px-2 py-1 rounded",onClick:()=>b(e.name),children:"Delete"})]},e.name))})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2616)}),_N_E=e.O()}]);