(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{1366:function(e,t,s){Promise.resolve().then(s.bind(s,4650))},4650:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),n=s(2265);function i(){let[e,t]=n.useState([]),[s,i]=n.useState(!0),[r,c]=n.useState(null);async function o(e){if(!(e.headers.get("content-type")||"").includes("application/json")){let t=await e.text();throw Error("Expected JSON but got ".concat(e.status," ").concat(e.statusText,". ")+"Check that /api/submissions/list exists. First bytes: ".concat(t.slice(0,120)))}return e.json()}async function l(){i(!0),c(null);try{let e=await fetch("/api/submissions/list",{cache:"no-store"}),s=await o(e);if(!e.ok)throw Error(s.error||e.statusText);t(s.items||[])}catch(e){c(e.message||"Failed to load")}finally{i(!1)}}async function d(e,t){let s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),cache:"no-store"});if(!(s.headers.get("content-type")||"").includes("application/json")){let t=await s.text();throw Error("Expected JSON but got ".concat(s.status," ").concat(s.statusText," from ").concat(e,". ")+"First bytes: ".concat(t.slice(0,120)))}let a=await s.json();if(!s.ok)throw Error(a.error||s.statusText);return a}async function u(e){try{await d("/api/submissions/approve",{id:e,reviewer:"admin",notes:""}),await l(),alert("Approved + published")}catch(e){alert("Approve failed: ".concat(e.message||e))}}async function p(e){try{let t=prompt("Optional note for rejection")||"";await d("/api/submissions/reject",{id:e,reviewer:"admin",notes:t}),await l(),alert("Rejected")}catch(e){alert("Reject failed: ".concat(e.message||e))}}return(n.useEffect(()=>{l()},[]),s)?(0,a.jsx)("main",{className:"p-6",children:"Loadingâ€¦"}):r?(0,a.jsxs)("main",{className:"p-6",children:[(0,a.jsxs)("p",{className:"text-red-700 font-medium",children:["Error: ",r]}),(0,a.jsxs)("p",{className:"text-sm mt-2",children:["Tip: open ",(0,a.jsx)("code",{children:"/api/submissions/list"})," directly in your browser. If that shows HTML or 404, the API route path or build is wrong."]})]}):(0,a.jsxs)("main",{className:"p-6 max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Pending Event Submissions"}),0===e.length?(0,a.jsx)("p",{children:"No pending submissions \uD83C\uDF89"}):null,(0,a.jsx)("ul",{className:"space-y-4",children:e.map(e=>(0,a.jsx)("li",{className:"border rounded p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.title||"(no title)"," ",(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["#",e.id]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.start," ",e.venue?"@ ".concat(e.venue):""]}),e.description?(0,a.jsx)("p",{className:"mt-2 text-sm",children:e.description}):null,e.source_url?(0,a.jsx)("a",{className:"text-sm underline",href:e.source_url,target:"_blank",rel:"noreferrer",children:"Source"}):null]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"border px-3 py-1 rounded",onClick:()=>u(e.id),children:"Approve"}),(0,a.jsx)("button",{className:"border px-3 py-1 rounded",onClick:()=>p(e.id),children:"Reject"})]})]})},e.id))})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=1366)}),_N_E=e.O()}]);